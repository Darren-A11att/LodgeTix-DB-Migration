=== ENHANCED PAYMENT SYNC LOG ===
Started at: 2025-08-12T03:09:43.768Z
Processing Square with orders/customers and contacts

âœ“ Supabase client initialized
âœ“ Square provider initialized (REQUIRED)
âœ“ DA-LODGETIX initialized
âœ“ WS-LODGETIX initialized
âœ“ WS-LODGETICKETS initialized

Initialized 4 payment provider(s)

=== STARTING ENHANCED PAYMENT SYNC ===
Processing workflow:
1. Import payment to payments_import
2. Fetch order/customer for Square payments
3. Find registration in Supabase
4. Update with charge ID for Stripe
5. Import to registrations_import
6. Link and import to final collections
7. Process attendees and tickets
8. Process contacts with deduplication

âœ“ Connected to MongoDB database: lodgetix

â”â”â” Processing Square â”â”â”

Fetching Square payments (cursor: blank)
Error fetching Square payments: Cannot read properties of undefined (reading 'listPayments')

â”â”â” Processing DA-LODGETIX â”â”â”

ğŸ“ Processing charge: ch_3RYNqYKBASow5NsW17D1d6gl
  âœ“ Imported charge to payments_import
  âœ“ Found registration: 222ddcc8-4f1a-4301-9e44-18a89770e1ed
  âœ“ Imported to registrations_import with charge ID
  âœ“ Imported to final collections
  âœ“ Found 1 attendee(s)
    âœ“ Processed contact: Darren Allatt
    âœ“ Found 0 ticket(s) for attendee undefined
  âœ… Completed processing charge ch_3RYNqYKBASow5NsW17D1d6gl

ğŸ“ Processing charge: ch_3RYNH3KBASow5NsW0hd6SVQA
  â­ï¸ Skipping - fully refunded
Reached limit of 2 for DA-LODGETIX

â”â”â” Processing WS-LODGETIX â”â”â”

ğŸ“ Processing charge: ch_3RatsQHDfNBUEWUu0i6JkO6W
  âœ“ Imported charge to payments_import
  âœ“ Found registration: 8a63ce42-9276-4254-b3cc-406d78cdbb16
  âœ“ Imported to registrations_import with charge ID
  âœ“ Imported to final collections
  âœ“ Found 1 attendee(s)
    âœ“ Processed contact: Amitava Sen
    âœ“ Found 0 ticket(s) for attendee undefined
  âœ… Completed processing charge ch_3RatsQHDfNBUEWUu0i6JkO6W

ğŸ“ Processing charge: ch_3RatmpHDfNBUEWUu0aKhh2Yq
  âœ“ Imported charge to payments_import
  âœ“ Found registration: a502eec2-4f0b-44aa-b605-a6ec622a546a
  âœ“ Imported to registrations_import with charge ID
  âœ“ Imported to final collections
  âœ“ Found 0 attendee(s)
  âœ… Completed processing charge ch_3RatmpHDfNBUEWUu0aKhh2Yq
Reached limit of 2 for WS-LODGETIX

â”â”â” Processing WS-LODGETICKETS â”â”â”

ğŸ“ Processing charge: ch_3RbJfOCari1bgsWq0CxPr7NI
  âœ“ Imported charge to payments_import
  âœ“ Found registration: 533f4153-ab85-4552-a372-2d71fc42e546
  âœ“ Imported to registrations_import with charge ID
  âœ“ Imported to final collections
  âœ“ Found 1 attendee(s)
    âœ“ Processed contact: Marcelo III Caguioa
    âœ“ Found 0 ticket(s) for attendee undefined
  âœ… Completed processing charge ch_3RbJfOCari1bgsWq0CxPr7NI

ğŸ“ Processing charge: ch_3RbGXFCari1bgsWq1HXOJzrX
  âœ“ Imported charge to payments_import
  âœ“ Found registration: 371a8bae-7c4f-4650-a0d6-085912e5f57c
  âœ“ Imported to registrations_import with charge ID
  âœ“ Imported to final collections
  âœ“ Found 1 attendee(s)
    âœ“ Processed contact: Jon Bon Jovi Macaraeg
    âœ“ Found 0 ticket(s) for attendee undefined
  âœ… Completed processing charge ch_3RbGXFCari1bgsWq1HXOJzrX
Reached limit of 2 for WS-LODGETICKETS

=== SYNC COMPLETE ===
âœ… Processed: 5
â­ï¸ Skipped: 1
âŒ Errors: 1
ğŸ‘¥ Unique contacts: 4
ğŸ“Š Total: 7
