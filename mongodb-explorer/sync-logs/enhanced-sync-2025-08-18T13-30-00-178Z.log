=== ENHANCED PAYMENT SYNC LOG ===
Started at: 2025-08-18T13:30:00.179Z
Processing Square with orders/customers and contacts

✓ Supabase client initialized
✓ Square provider initialized (REQUIRED)
✓ DA-LODGETIX initialized
✓ WS-LODGETIX initialized
✓ WS-LODGETICKETS initialized

Initialized 4 payment provider(s)
✓ Connected to MongoDB:
  Cluster: LodgeTix-migration-test-1
  Database: lodgetix
  URI: mongodb+srv:****@lodgetix-migration-test.wydwfu6.mongodb.net/lodgetix?retryWrites=true&w=majority&appName=LodgeTix-migration-test-1

=== STARTING ENHANCED PAYMENT SYNC ===
Processing workflow:
1. Import payment to import_payments (with field transformation)
2. Fetch order/customer for Square payments
3. Find registration in Supabase
4. Update with charge ID for Stripe
5. Import to import_registrations (with field transformation)
6. Import attendees to import_attendees
7. Import tickets to import_tickets
8. Import contacts to import_contacts with deduplication
9. Process booking contact as customer with registration metadata
9. Selective sync to production collections based on field comparison


━━━ Processing Square ━━━

Fetching ALL historical Square payments (one at a time)...
  Fetched payment 1 (cursor: none)

📝 Processing Square payment: Jo8Xt6W86o0fUOrhcipCfShVOaJZY
  ✅ Importing completed payment - status: COMPLETED
  🛒 Fetching order: zCWnYWcx7XA4NRazimTD0rGLM3DZY
    ✓ Order fetched
  👤 Fetching customer: SW0VPA12W73BT6GTQ0NZ1HMK94
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 8a516a0f-c5af-45ac-b974-e542342c738d
  ✓ Updated import_payments with registrationId: 8a516a0f-c5af-45ac-b974-e542342c738d
  ✓ Imported FULL registration to import_registrations with field transformation
  📝 Processing booking contact as customer
    Customer data created: PAUL  FANDOUX
    ✓ Created new customer: PAUL  FANDOUX
    ✓ Updated registration with customer reference: 1833dac3-59c6-40d3-a733-974b72894ba7
  ✓ Found customer data for ticket ownership: PAUL  FANDOUX
    Extracting 6 attendees from registration_data
    🔍 Looking up grand lodge: 3e893fa6-2cc2-448c-be9c-e3858cc90e11
    🔍 Looking up grand lodge: 3e893fa6-2cc2-448c-be9c-e3858cc90e11
    ✓ Found grand lodge name: United Grand Lodge of New South Wales & Australian Capital Territory
    ✓ Found grand lodge name: United Grand Lodge of New South Wales & Australian Capital Territory
  ✓ Found 6 attendee(s)
    Extracting 6 tickets from registration_data.selectedTickets
    Total tickets after expansion: 6
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📦 Returning 6 processed tickets from registration_data
  ✓ Found 6 ticket(s) in registration
    💾 Saving ticket to import_tickets: 0198bd48-ab17-716c-ba8f-7af134d0717c-d586ecc1-e410-4ef3-a59c-4a53a866bc33 (Meet & Greet Cocktail Party, qty: 1)
      ✅ Created ticket document
    💾 Saving ticket to import_tickets: 0198bd49-b74b-71b7-a93d-a47944b9ce01-d586ecc1-e410-4ef3-a59c-4a53a866bc33 (Meet & Greet Cocktail Party, qty: 1)
      ✅ Created ticket document
    💾 Saving ticket to import_tickets: 0198bd4a-7eee-739c-9fe9-fc214dd89f80-d586ecc1-e410-4ef3-a59c-4a53a866bc33 (Meet & Greet Cocktail Party, qty: 1)
      ✅ Created ticket document
    💾 Saving ticket to import_tickets: 0198bd4b-4dbf-7708-95cf-b1bca13ee27b-d586ecc1-e410-4ef3-a59c-4a53a866bc33 (Meet & Greet Cocktail Party, qty: 1)
      ✅ Created ticket document
    💾 Saving ticket to import_tickets: 0198bd4b-e432-708c-97ba-1ded9ae00144-d586ecc1-e410-4ef3-a59c-4a53a866bc33 (Meet & Greet Cocktail Party, qty: 1)
      ✅ Created ticket document
    💾 Saving ticket to import_tickets: 0198bd4c-8b24-7728-9d03-6a399d3fa32d-d586ecc1-e410-4ef3-a59c-4a53a866bc33 (Meet & Greet Cocktail Party, qty: 1)
      ✅ Created ticket document
    📝 Created registration reference: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    ✨ Creating new contact with role 'attendee': PAUL  FANDOUX
    📋 Registrations added: 1 items
      1. Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d) - Conf: IND-342061DL
    ✓ Processed unified contact: PAUL  FANDOUX (roles: attendee)
    📝 Created registration reference: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    ✓ Contact already exists in production - skipping sync but tracking: LAETITIA FANDOUX
    📝 Created registration reference: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    📝 Added registration to existing contact: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    🔄 Updated existing contact with new role 'attendee': LOUIS  FANDOUX
    📝 Created registration reference: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    📝 Added registration to existing contact: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    🔄 Updated existing contact with new role 'attendee': MERYL SABERI
    📝 Created registration reference: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    📝 Added registration to existing contact: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    🔄 Updated existing contact with new role 'attendee': JEAN-PAUL DANG VAN NHA
    📝 Created registration reference: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    📝 Added registration to existing contact: Grand Proclamation 2025 (8a516a0f-c5af-45ac-b974-e542342c738d)
    🔄 Updated existing contact with new role 'attendee': FABIENNE DANG VAN NHA
  📝 Updating registration with extracted references
    ✅ Updated registration with 6 ticket IDs (6 ObjectIds) and 6 attendee IDs (6 ObjectIds)
  ✅ Completed processing Square payment Jo8Xt6W86o0fUOrhcipCfShVOaJZY (production eligible)
  🔄 Syncing payment data to production...
    → Syncing payment Jo8Xt6W86o0fUOrhcipCfShVOaJZY data to production...
      ✓ Payment synced to production
      ✓ Registration synced to production
      ✓ Customer 1833dac3-59c6-40d3-a733-974b72894ba7 synced to production
      ✓ Attendee 0198bd48-ab17-716c-ba8f-7af134d0717c synced to production
      ✓ Attendee 0198bd49-b74b-71b7-a93d-a47944b9ce01 synced to production
      ✓ Attendee 0198bd4a-7eee-739c-9fe9-fc214dd89f80 synced to production
      ✓ Attendee 0198bd4b-4dbf-7708-95cf-b1bca13ee27b synced to production
      ✓ Attendee 0198bd4b-e432-708c-97ba-1ded9ae00144 synced to production
      ✓ Attendee 0198bd4c-8b24-7728-9d03-6a399d3fa32d synced to production
      ✓ Contact jpfexpert@gmail.cpm synced to production
      ✓ Ticket 0198bd48-ab17-716c-ba8f-7af134d0717c-d586ecc1-e410-4ef3-a59c-4a53a866bc33 synced to production
      ✓ Ticket 0198bd49-b74b-71b7-a93d-a47944b9ce01-d586ecc1-e410-4ef3-a59c-4a53a866bc33 synced to production
      ✓ Ticket 0198bd4a-7eee-739c-9fe9-fc214dd89f80-d586ecc1-e410-4ef3-a59c-4a53a866bc33 synced to production
      ✓ Ticket 0198bd4b-4dbf-7708-95cf-b1bca13ee27b-d586ecc1-e410-4ef3-a59c-4a53a866bc33 synced to production
      ✓ Ticket 0198bd4b-e432-708c-97ba-1ded9ae00144-d586ecc1-e410-4ef3-a59c-4a53a866bc33 synced to production
      ✓ Ticket 0198bd4c-8b24-7728-9d03-6a399d3fa32d-d586ecc1-e410-4ef3-a59c-4a53a866bc33 synced to production
    ✅ Payment Jo8Xt6W86o0fUOrhcipCfShVOaJZY complete data chain synced to production
  ✅ Payment data synced to production
  Got cursor for next payment
  Fetched payment 2 (cursor: provided)

📝 Processing Square payment: F6oCqaqnzPwfTGdhPYIZIBucz3HZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 3 (cursor: provided)

📝 Processing Square payment: Hhxbd0PywfAYLWhJE4QIteGTPPAZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 4 (cursor: provided)

📝 Processing Square payment: 1kB0VhS29vRIlnI7pwTLBkZ0j7AZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 5 (cursor: provided)

📝 Processing Square payment: 5WZURjeHRtZKVpza9ECnKKz2R6cZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 6 (cursor: provided)

📝 Processing Square payment: 5GXVymBC3x18occbL5IXfi34knaZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 7 (cursor: provided)

📝 Processing Square payment: 37uzagXg6306GrJSUUf574HvB0CZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 8 (cursor: provided)

📝 Processing Square payment: jtwvvCSh0dwASWgUW1TAfF2l635YY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 9 (cursor: provided)

📝 Processing Square payment: 7nHbZYYBn7M1thYdSmgNo9n28yKZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 10 (cursor: provided)

📝 Processing Square payment: p4g7czFGnXbMPrHYOtWSnqCieZLZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 11 (cursor: provided)

📝 Processing Square payment: JOBqwBmraQ1ECS1fVhtdy55ZrrMZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 12 (cursor: provided)

📝 Processing Square payment: bHpqGQWwCK6aDNnbhv6ChzltfedZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 13 (cursor: provided)

📝 Processing Square payment: TFOQEKkW2rQS4WHUBdIjyoSj0EJZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 14 (cursor: provided)

📝 Processing Square payment: ZGvLjl0ZA3MT9vf33jacwBNG5ycZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 15 (cursor: provided)

📝 Processing Square payment: h8gN46mZTfnGV8xDOWY7q4nnsVPZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 16 (cursor: provided)

📝 Processing Square payment: NQtKfWQJ2pMEfWLqgqbhTOSQVgeZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 17 (cursor: provided)

📝 Processing Square payment: 3l9mbrzU72IPMJ1vscl47aM5EzeZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 18 (cursor: provided)

📝 Processing Square payment: jfPss6uLfMf6Sy8Z7WtPH9FLERKZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 19 (cursor: provided)

📝 Processing Square payment: VaU4RCrbBAky4Jpe4pvV1GBwRSJZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 20 (cursor: provided)

📝 Processing Square payment: T1AjRFv4v2jHjyoHPOvHp3jF2BJZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 21 (cursor: provided)

📝 Processing Square payment: DLDhRUZVwCaYfLXVguPIa7c2TBTZY
  📥 Importing non-completed payment - status: FAILED (will not move to production)
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: DLDhRUZVwCaYfLXVguPIa7c2TBTZY
  🛒 Fetching order: jWwz7Uxidz4PeSLPg918oz0X3wXZY
    ✓ Order fetched
  👤 Fetching customer: 6AV409Q89NWNMCVYXM82HSX4RM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  📝 No registration found for payment: DLDhRUZVwCaYfLXVguPIa7c2TBTZY
  ✓ Updated import_payments with registrationId: no-match
  ℹ️ FAILED payment - no match is not an error
  Got cursor for next payment
  Fetched payment 22 (cursor: provided)

📝 Processing Square payment: jhU6YnfsNom1Wu5UEwTpuTUOfkbZY
  📥 Importing non-completed payment - status: FAILED (will not move to production)
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: jhU6YnfsNom1Wu5UEwTpuTUOfkbZY
  🛒 Fetching order: lRHUbFrVLiFaXJ7gCrKirTsbMfJZY
    ✓ Order fetched
  👤 Fetching customer: 6AV409Q89NWNMCVYXM82HSX4RM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  📝 No registration found for payment: jhU6YnfsNom1Wu5UEwTpuTUOfkbZY
  ✓ Updated import_payments with registrationId: no-match
  ℹ️ FAILED payment - no match is not an error
  Got cursor for next payment
  Fetched payment 23 (cursor: provided)

📝 Processing Square payment: ByHBzneYeEzSiok0AlGqi7v7N6NZY
  📥 Importing non-completed payment - status: FAILED (will not move to production)
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: ByHBzneYeEzSiok0AlGqi7v7N6NZY
  🛒 Fetching order: JXP7Z0ckjqFu5oTSv7OudCIjzFRZY
    ✓ Order fetched
  👤 Fetching customer: 6AV409Q89NWNMCVYXM82HSX4RM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  📝 No registration found for payment: ByHBzneYeEzSiok0AlGqi7v7N6NZY
  ✓ Updated import_payments with registrationId: no-match
  ℹ️ FAILED payment - no match is not an error
  Got cursor for next payment
  Fetched payment 24 (cursor: provided)

📝 Processing Square payment: hmHkLkSEY6gu1Nngf1LYIBaLnPJZY
  📥 Importing non-completed payment - status: FAILED (will not move to production)
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: hmHkLkSEY6gu1Nngf1LYIBaLnPJZY
  🛒 Fetching order: hdkX92qVGPjrnucp472nFPOFO9CZY
    ✓ Order fetched
  👤 Fetching customer: 6AV409Q89NWNMCVYXM82HSX4RM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  📝 No registration found for payment: hmHkLkSEY6gu1Nngf1LYIBaLnPJZY
  ✓ Updated import_payments with registrationId: no-match
  ℹ️ FAILED payment - no match is not an error
  Got cursor for next payment
  Fetched payment 25 (cursor: provided)

📝 Processing Square payment: zNueSiS1Y3GP59FJH7A62k4tMrTZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 26 (cursor: provided)

📝 Processing Square payment: r9ACcx4DHuxDspPsS8xlhWFWKk7YY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 27 (cursor: provided)

📝 Processing Square payment: BYKXKLGaomF5fqksWnC2BDShYz9YY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 28 (cursor: provided)

📝 Processing Square payment: H7MsmC9fLnNjwZCB50pm6oUhDZCZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 29 (cursor: provided)

📝 Processing Square payment: Xbs2Q3X1vEvZJnSLSnrbaOF4z1EZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 30 (cursor: provided)

📝 Processing Square payment: 1iYmmAImrRvMZ9FE839tL7f6ZJDZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 31 (cursor: provided)

📝 Processing Square payment: LHxGj2N2xehd2SVPRgahL09Z4bOZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 32 (cursor: provided)

📝 Processing Square payment: HnMhwDtTEYP9hcTF0UHH7Y8UTbBZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 33 (cursor: provided)

📝 Processing Square payment: 3tJyXZgwjgLBCHoyV2uARwGBswdZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 34 (cursor: provided)

📝 Processing Square payment: vlvOb3ZJBzQJ0XzoCOOCm3lVn2VZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 35 (cursor: provided)

📝 Processing Square payment: F8t2nIaFgyXCsaClrIb76CGn5fKZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 36 (cursor: provided)

📝 Processing Square payment: DbJ0DmwrCW68Xy80jcjBhSu1TSTZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 37 (cursor: provided)

📝 Processing Square payment: 3ZJ3HBSr4UdPafNCaBainy55wc7YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 3ZJ3HBSr4UdPafNCaBainy55wc7YY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: 1D6JIYsyPosqijXocbFPCziiNcbZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: 3ZJ3HBSr4UdPafNCaBainy55wc7YY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 38 (cursor: provided)

📝 Processing Square payment: XZvsmRdAo7cOcbytf8tXyQopLI6YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: XZvsmRdAo7cOcbytf8tXyQopLI6YY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: Xs2L35wjYWhx3HvrklClX3a0BuNZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: XZvsmRdAo7cOcbytf8tXyQopLI6YY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 39 (cursor: provided)

📝 Processing Square payment: lqOt4jZnIiTTlE97PDYCV3tShsPZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: lqOt4jZnIiTTlE97PDYCV3tShsPZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: r4PTP2Qxwslt7ZxZaKlLzqYSShcZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: lqOt4jZnIiTTlE97PDYCV3tShsPZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 40 (cursor: provided)

📝 Processing Square payment: zVoh8VCpVfGVFHDPCb6tQiG9uJ8YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: zVoh8VCpVfGVFHDPCb6tQiG9uJ8YY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: DARLGQPmU3VLYeCjH2NCxjYWrgHZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: zVoh8VCpVfGVFHDPCb6tQiG9uJ8YY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 41 (cursor: provided)

📝 Processing Square payment: ZggJj2u2p8iwhRWOajCzg0zZ2YEZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: ZggJj2u2p8iwhRWOajCzg0zZ2YEZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: fCV69dX4Zze30HVeTpuzqAjjWUaZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: ZggJj2u2p8iwhRWOajCzg0zZ2YEZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 42 (cursor: provided)

📝 Processing Square payment: jjZo8QIRaYRVHjWEF6kGT2A8SqYZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: jjZo8QIRaYRVHjWEF6kGT2A8SqYZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: PsYp8u1YP1En0Te0r2ckAR3x3xCZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: jjZo8QIRaYRVHjWEF6kGT2A8SqYZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 43 (cursor: provided)

📝 Processing Square payment: XbYcqGOlLYy34w8GRh6oDKYqSKKZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: XbYcqGOlLYy34w8GRh6oDKYqSKKZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: P69g27WnaUvxwgatO0njdtNHp5SZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: XbYcqGOlLYy34w8GRh6oDKYqSKKZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 44 (cursor: provided)

📝 Processing Square payment: xECGubABWxwHhK8cYuzZJdzEfONZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: xECGubABWxwHhK8cYuzZJdzEfONZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: 7MX0fi49HRM9cSl6CI6J8uMU9sCZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: xECGubABWxwHhK8cYuzZJdzEfONZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 45 (cursor: provided)

📝 Processing Square payment: xSlYUjRPlvBqdFASpTgzxyAq1RHZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: xSlYUjRPlvBqdFASpTgzxyAq1RHZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: hr7zXW4nU2W6e1anMyyghhVmF0YZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: xSlYUjRPlvBqdFASpTgzxyAq1RHZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 46 (cursor: provided)

📝 Processing Square payment: 7NcA5XmQQnii5C4wyZ49VRv4O6bZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 7NcA5XmQQnii5C4wyZ49VRv4O6bZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: nsMMDuSVkztzJFtyVuhVmcuCbW8YY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: 7NcA5XmQQnii5C4wyZ49VRv4O6bZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 47 (cursor: provided)

📝 Processing Square payment: jXbMStnAmtjde3RrcJyeFi1fUuRZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: jXbMStnAmtjde3RrcJyeFi1fUuRZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: FvQPGKRNYcvNCGXEUKrIL9vRogWZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: jXbMStnAmtjde3RrcJyeFi1fUuRZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 48 (cursor: provided)

📝 Processing Square payment: NkToF5EmmRnVVpX6UAqwfq6nBLNZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: NkToF5EmmRnVVpX6UAqwfq6nBLNZY
  📊 Found 1 stale error_payments record(s) to clean up
  ✅ Cleaned up 1 stale error record(s)
  🛒 Fetching order: 1BBLtJ7rsJaJqWuJoOkm4HDpMbVZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: NkToF5EmmRnVVpX6UAqwfq6nBLNZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 49 (cursor: provided)

📝 Processing Square payment: 3zOzdaBQtF8P6LmaVkIriaGTYKeZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 50 (cursor: provided)

📝 Processing Square payment: LZkdOfjFmPKMhwgBnK0HTv3arvJZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 51 (cursor: provided)

📝 Processing Square payment: 9Q1czaAuSZ3MLpRIjWwQ5qK8LlOZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 52 (cursor: provided)

📝 Processing Square payment: bX925MCTlcedZE16Y5isSOiOY47YY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 53 (cursor: provided)

📝 Processing Square payment: TFQpQg9T6EMRNsVMCRqzqF9mg1WZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
  Fetched payment 54 (cursor: provided)

📝 Processing Square payment: ZAMti0WeQC6bzau6xzcwAt5brqKZY
  ✅ Importing completed payment - status: COMPLETED
  ✓ Payment already exists in production - skipping
  Got cursor for next payment
