=== ENHANCED PAYMENT SYNC LOG ===
Started at: 2025-08-17T08:32:37.400Z
Processing Square with orders/customers and contacts

✓ Supabase client initialized
✓ Square provider initialized (REQUIRED)
✓ DA-LODGETIX initialized
✓ WS-LODGETIX initialized
✓ WS-LODGETICKETS initialized

Initialized 4 payment provider(s)

=== STARTING ENHANCED PAYMENT SYNC ===
Processing workflow:
1. Import payment to import_payments (with field transformation)
2. Fetch order/customer for Square payments
3. Find registration in Supabase
4. Update with charge ID for Stripe
5. Import to import_registrations (with field transformation)
6. Import attendees to import_attendees
7. Import tickets to import_tickets
8. Import contacts to import_contacts with deduplication
9. Process booking contact as customer with registration metadata
9. Selective sync to production collections based on field comparison

✓ Connected to MongoDB:
  Cluster: LodgeTix-migration-test-1
  Database: lodgetix
  URI: mongodb+srv:****@lodgetix-migration-test.wydwfu6.mongodb.net/lodgetix?retryWrites=true&w=majority&appName=LodgeTix-migration-test-1

━━━ Processing Square ━━━

Fetching ALL historical Square payments (one at a time)...
  Fetched payment 1 (cursor: none)

📝 Processing Square payment: 5WZURjeHRtZKVpza9ECnKKz2R6cZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 5WZURjeHRtZKVpza9ECnKKz2R6cZY
  🛒 Fetching order: jInUk4vuEf5EkHjI18nbjnKF54LZY
    ✓ Order fetched
  👤 Fetching customer: QZXPY8QN30GXA89KB6TT9B2J54
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 232d7ba5-0795-41b8-9532-1747580c5693
  ✓ Updated import_payments with registrationId: 232d7ba5-0795-41b8-9532-1747580c5693
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Lesley  Hicks
    ✓ Updated existing customer: Lesley  Hicks
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 4 tickets from registration_data.selectedTickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📦 Returning 4 processed tickets from registration_data
  ✓ Found 4 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_232d7ba5-0795-41b8-9532-1747580c5693_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment 5WZURjeHRtZKVpza9ECnKKz2R6cZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193a7e56fc04fe4a7a031')
  Got cursor for next payment
  Fetched payment 2 (cursor: provided)

📝 Processing Square payment: 5GXVymBC3x18occbL5IXfi34knaZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 5GXVymBC3x18occbL5IXfi34knaZY
  🛒 Fetching order: J56sPyUq53BMVGNcSjNqJZ2blEXZY
    ✓ Order fetched
  👤 Fetching customer: XVP1HKZQN7ANCMSMPRDN4GCJYC
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 535b823e-c4b2-4876-80d1-cf608be46c78
  ✓ Updated import_payments with registrationId: 535b823e-c4b2-4876-80d1-cf608be46c78
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Anton Cabunilas
    ✓ Updated existing customer: Anton Cabunilas
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 3 tickets from registration_data.selectedTickets
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📦 Returning 3 processed tickets from registration_data
  ✓ Found 3 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_535b823e-c4b2-4876-80d1-cf608be46c78_ticket_0 (Grand Proclamation Ceremony, qty: 1)
  ❌ Error processing Square payment 5GXVymBC3x18occbL5IXfi34knaZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193a9e56fc04fe4a7a03c')
  Got cursor for next payment
  Fetched payment 3 (cursor: provided)

📝 Processing Square payment: 37uzagXg6306GrJSUUf574HvB0CZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 37uzagXg6306GrJSUUf574HvB0CZY
  🛒 Fetching order: zMfh4O5L6fT6UJxue10qrTC7C9NZY
    ✓ Order fetched
  👤 Fetching customer: QWW6PXCPMQK1NYTBQ8XQGGDDA0
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: dcb47cfb-fe4c-4fc4-a373-2805500e797f
  ✓ Updated import_payments with registrationId: dcb47cfb-fe4c-4fc4-a373-2805500e797f
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Ian Hogan
    ✓ Updated existing customer: Ian Hogan
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 5 tickets from registration_data.selectedTickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    🔍 Looking up eventTicket: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    ✅ Found eventTicket: Existing Banquet Ticket bought by Lodge (price: [object Object])
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📦 Returning 5 processed tickets from registration_data
  ✓ Found 5 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_dcb47cfb-fe4c-4fc4-a373-2805500e797f_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment 37uzagXg6306GrJSUUf574HvB0CZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193aae56fc04fe4a7a046')
  Got cursor for next payment
  Fetched payment 4 (cursor: provided)

📝 Processing Square payment: jtwvvCSh0dwASWgUW1TAfF2l635YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: jtwvvCSh0dwASWgUW1TAfF2l635YY
  🛒 Fetching order: 7yaaYVdcdEKNVAONK7yjFOSXI5YZY
    ✓ Order fetched
  👤 Fetching customer: 95DXMSZ5F6T26CNSDZKASYSXVC
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 1dfc42bb-7fae-4cff-a763-f57934a880e0
  ✓ Updated import_payments with registrationId: 1dfc42bb-7fae-4cff-a763-f57934a880e0
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Jonathan Vergara
    ✓ Updated existing customer: Jonathan Vergara
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 3 tickets from registration_data.selectedTickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 3 processed tickets from registration_data
  ✓ Found 3 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_1dfc42bb-7fae-4cff-a763-f57934a880e0_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment jtwvvCSh0dwASWgUW1TAfF2l635YY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193abe56fc04fe4a7a056')
  Got cursor for next payment
  Fetched payment 5 (cursor: provided)

📝 Processing Square payment: 7nHbZYYBn7M1thYdSmgNo9n28yKZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 7nHbZYYBn7M1thYdSmgNo9n28yKZY
  🛒 Fetching order: BdkhqdA7K07dYEot5ELbumhNq5NZY
    ✓ Order fetched
  👤 Fetching customer: MNKR0AM5HCMYB5TAJJ2CJSVWY4
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: e976c5a7-e506-4acf-a718-d893ded67f10
  ✓ Updated import_payments with registrationId: e976c5a7-e506-4acf-a718-d893ded67f10
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Abraham Constantin
    ✓ Updated existing customer: Abraham Constantin
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 1 tickets from registration_data.selectedTickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📦 Returning 1 processed tickets from registration_data
  ✓ Found 1 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_e976c5a7-e506-4acf-a718-d893ded67f10_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment 7nHbZYYBn7M1thYdSmgNo9n28yKZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193ace56fc04fe4a7a060')
  Got cursor for next payment
  Fetched payment 6 (cursor: provided)

📝 Processing Square payment: p4g7czFGnXbMPrHYOtWSnqCieZLZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: p4g7czFGnXbMPrHYOtWSnqCieZLZY
  🛒 Fetching order: Ts560QoctAIxc4p53odwFYbARhdZY
    ✓ Order fetched
  👤 Fetching customer: D8VRXK9JQB32E9RDYWMJFW5YJW
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 385f58c7-9a3b-4b45-9e3c-d461fdc6b19d
  ✓ Updated import_payments with registrationId: 385f58c7-9a3b-4b45-9e3c-d461fdc6b19d
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Gregg Summerhayes
    ✓ Updated existing customer: Gregg Summerhayes
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 3 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 3 processed tickets from registration_data
  ✓ Found 3 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_385f58c7-9a3b-4b45-9e3c-d461fdc6b19d_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment p4g7czFGnXbMPrHYOtWSnqCieZLZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193ade56fc04fe4a7a068')
  Got cursor for next payment
  Fetched payment 7 (cursor: provided)

📝 Processing Square payment: JOBqwBmraQ1ECS1fVhtdy55ZrrMZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: JOBqwBmraQ1ECS1fVhtdy55ZrrMZY
  🛒 Fetching order: n8GnYoEqmNkQlt51ZZ3NuRcIBYKZY
    ✓ Order fetched
  👤 Fetching customer: XZ9GVRZQN2JXT6JXPAEQBHW2EM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: cdc7fc39-8828-4f75-9314-66e54534da7a
  ✓ Updated import_payments with registrationId: cdc7fc39-8828-4f75-9314-66e54534da7a
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Jaime Flores
    ✓ Updated existing customer: Jaime Flores
    ✓ Updated registration with customer ObjectId
    Extracting 4 attendees from registration_data
  ✓ Found 4 attendee(s)
    Extracting 4 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 4 processed tickets from registration_data
  ✓ Found 4 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_cdc7fc39-8828-4f75-9314-66e54534da7a_ticket_0 (Grand Proclamation Ceremony, qty: 1)
  ❌ Error processing Square payment JOBqwBmraQ1ECS1fVhtdy55ZrrMZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193aee56fc04fe4a7a07e')
  Got cursor for next payment
  Fetched payment 8 (cursor: provided)

📝 Processing Square payment: bHpqGQWwCK6aDNnbhv6ChzltfedZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: bHpqGQWwCK6aDNnbhv6ChzltfedZY
  🛒 Fetching order: FPmQ5qiVt7iViWKP2SiY0FaxNFVZY
    ✓ Order fetched
  👤 Fetching customer: MJZGR09135ERMH9SSEKP41TB2R
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: ad076c4f-95a4-4fb0-9e50-521916386d64
  ✓ Updated import_payments with registrationId: ad076c4f-95a4-4fb0-9e50-521916386d64
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Shannan Summers
    ✓ Updated existing customer: Shannan Summers
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_ad076c4f-95a4-4fb0-9e50-521916386d64_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment bHpqGQWwCK6aDNnbhv6ChzltfedZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193b0e56fc04fe4a7a089')
  Got cursor for next payment
  Fetched payment 9 (cursor: provided)

📝 Processing Square payment: TFOQEKkW2rQS4WHUBdIjyoSj0EJZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: TFOQEKkW2rQS4WHUBdIjyoSj0EJZY
  🛒 Fetching order: PmrqVJtirgH1fdESY0p1cy8J9PJZY
    ✓ Order fetched
  👤 Fetching customer: A09RKAAZVBGMWKHG63NQ9MWDK4
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: a27ae77c-5e64-463f-a20e-c39febc3b537
  ✓ Updated import_payments with registrationId: a27ae77c-5e64-463f-a20e-c39febc3b537
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Sydney D Melville
    ✓ Updated existing customer: Sydney D Melville
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 5 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📦 Returning 5 processed tickets from registration_data
  ✓ Found 5 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_a27ae77c-5e64-463f-a20e-c39febc3b537_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment TFOQEKkW2rQS4WHUBdIjyoSj0EJZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193b1e56fc04fe4a7a096')
  Got cursor for next payment
  Fetched payment 10 (cursor: provided)

📝 Processing Square payment: ZGvLjl0ZA3MT9vf33jacwBNG5ycZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: ZGvLjl0ZA3MT9vf33jacwBNG5ycZY
  🛒 Fetching order: dNP0foHRyJX71IcgjllYOP4nal7YY
    ✓ Order fetched
  👤 Fetching customer: PM82SG2V8EXAX1QF1D1ARP1D4G
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 796c4447-b3f8-404b-8610-322b61f92985
  ✓ Updated import_payments with registrationId: 796c4447-b3f8-404b-8610-322b61f92985
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: William Jarwin  Sy
    ✓ Updated existing customer: William Jarwin  Sy
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    🔍 Looking up eventTicket: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    ✅ Found eventTicket: Existing Banquet Ticket bought by Lodge (price: [object Object])
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_796c4447-b3f8-404b-8610-322b61f92985_ticket_0 (Grand Proclamation Ceremony, qty: 1)
  ❌ Error processing Square payment ZGvLjl0ZA3MT9vf33jacwBNG5ycZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193b3e56fc04fe4a7a0a2')
  Got cursor for next payment
  Fetched payment 11 (cursor: provided)

📝 Processing Square payment: h8gN46mZTfnGV8xDOWY7q4nnsVPZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: h8gN46mZTfnGV8xDOWY7q4nnsVPZY
  🛒 Fetching order: ltBcU3AhUBpJNKnwUr1Af6H8qcIZY
    ✓ Order fetched
  👤 Fetching customer: M24SZ52MDNDS8EBQQ2QF7SVR2W
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: fa2a849a-1276-444e-bd93-a2303871e5f5
  ✓ Updated import_payments with registrationId: fa2a849a-1276-444e-bd93-a2303871e5f5
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Scott MAYER
    ✓ Updated existing customer: Scott MAYER
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_fa2a849a-1276-444e-bd93-a2303871e5f5_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment h8gN46mZTfnGV8xDOWY7q4nnsVPZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193b4e56fc04fe4a7a0ab')
  Got cursor for next payment
  Fetched payment 12 (cursor: provided)

📝 Processing Square payment: NQtKfWQJ2pMEfWLqgqbhTOSQVgeZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: NQtKfWQJ2pMEfWLqgqbhTOSQVgeZY
  🛒 Fetching order: 9Twt8vGtP7spniLTAyiXrM3dVvQZY
    ✓ Order fetched
  👤 Fetching customer: CNBS19TD5QKYGR9FRVHKDG6HG4
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: f6d6bc9a-465a-4ed3-85ef-4e9b312fea2b
  ✓ Updated import_payments with registrationId: f6d6bc9a-465a-4ed3-85ef-4e9b312fea2b
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Bob Burbank
    ✓ Updated existing customer: Bob Burbank
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 3 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 3 processed tickets from registration_data
  ✓ Found 3 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_f6d6bc9a-465a-4ed3-85ef-4e9b312fea2b_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment NQtKfWQJ2pMEfWLqgqbhTOSQVgeZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193b5e56fc04fe4a7a0b8')
  Got cursor for next payment
  Fetched payment 13 (cursor: provided)

📝 Processing Square payment: 3l9mbrzU72IPMJ1vscl47aM5EzeZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 3l9mbrzU72IPMJ1vscl47aM5EzeZY
  🛒 Fetching order: 9ppiz3e32Y8XhEo3HWVOfMGonuFZY
    ✓ Order fetched
  👤 Fetching customer: 2S5AZ8HTW2RETTYVFKW0V4103W
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: d2cfbf4d-1c03-4aa7-84cc-37f7b0ad87d3
  ✓ Updated import_payments with registrationId: d2cfbf4d-1c03-4aa7-84cc-37f7b0ad87d3
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Greg Hind
    ✓ Updated existing customer: Greg Hind
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_d2cfbf4d-1c03-4aa7-84cc-37f7b0ad87d3_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment 3l9mbrzU72IPMJ1vscl47aM5EzeZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193b6e56fc04fe4a7a0c2')
  Got cursor for next payment
  Fetched payment 14 (cursor: provided)

📝 Processing Square payment: jfPss6uLfMf6Sy8Z7WtPH9FLERKZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: jfPss6uLfMf6Sy8Z7WtPH9FLERKZY
  🛒 Fetching order: Rr94kz2q0ynGYLp1cjhpi2stM6bZY
    ✓ Order fetched
  👤 Fetching customer: 13D7AHDZPXR0H63P5YK28B0AZ4
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 19cea4d0-6f5a-489a-abc8-56c4980b37d0
  ✓ Updated import_payments with registrationId: 19cea4d0-6f5a-489a-abc8-56c4980b37d0
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Romy Nieto
    ✓ Updated existing customer: Romy Nieto
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 3 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 3 processed tickets from registration_data
  ✓ Found 3 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_19cea4d0-6f5a-489a-abc8-56c4980b37d0_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment jfPss6uLfMf6Sy8Z7WtPH9FLERKZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193b7e56fc04fe4a7a0cf')
  Got cursor for next payment
  Fetched payment 15 (cursor: provided)

📝 Processing Square payment: VaU4RCrbBAky4Jpe4pvV1GBwRSJZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: VaU4RCrbBAky4Jpe4pvV1GBwRSJZY
  🛒 Fetching order: XEUaA2VChCDdrTsMfGKOtSze5bJZY
    ✓ Order fetched
  👤 Fetching customer: XDWVTVPPYZEPDHVK55TA1YTS7R
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: aaef562e-92c4-4f6e-860c-e9874dec341e
  ✓ Updated import_payments with registrationId: aaef562e-92c4-4f6e-860c-e9874dec341e
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Juan Carlos Flores
    ✓ Updated existing customer: Juan Carlos Flores
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_aaef562e-92c4-4f6e-860c-e9874dec341e_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment VaU4RCrbBAky4Jpe4pvV1GBwRSJZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193b8e56fc04fe4a7a0dd')
  Got cursor for next payment
  Fetched payment 16 (cursor: provided)

📝 Processing Square payment: T1AjRFv4v2jHjyoHPOvHp3jF2BJZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: T1AjRFv4v2jHjyoHPOvHp3jF2BJZY
  🛒 Fetching order: tj4l17DY50XOIO1kKNYMDWOZK8FZY
    ✓ Order fetched
  👤 Fetching customer: KF1GGP49BFENFBS1JBT51PV82G
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: d9bc7cb7-31c1-4a13-8a92-c293f3d1cf63
  ✓ Updated import_payments with registrationId: d9bc7cb7-31c1-4a13-8a92-c293f3d1cf63
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Gustavo Fiestas
    ✓ Updated existing customer: Gustavo Fiestas
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 5 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    🔍 Looking up eventTicket: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    ✅ Found eventTicket: Existing Banquet Ticket bought by Lodge (price: [object Object])
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📦 Returning 5 processed tickets from registration_data
  ✓ Found 5 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_d9bc7cb7-31c1-4a13-8a92-c293f3d1cf63_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment T1AjRFv4v2jHjyoHPOvHp3jF2BJZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193bae56fc04fe4a7a0e6')
  Got cursor for next payment
  Fetched payment 17 (cursor: provided)

📝 Processing Square payment: DLDhRUZVwCaYfLXVguPIa7c2TBTZY
  📥 Importing non-completed payment - status: FAILED (will not move to production)
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: DLDhRUZVwCaYfLXVguPIa7c2TBTZY
  🛒 Fetching order: jWwz7Uxidz4PeSLPg918oz0X3wXZY
    ✓ Order fetched
  👤 Fetching customer: 6AV409Q89NWNMCVYXM82HSX4RM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  📝 No registration found for payment: DLDhRUZVwCaYfLXVguPIa7c2TBTZY
  ✓ Updated import_payments with registrationId: no-match
  ℹ️ Failed/refunded payment - no match is not an error
  Got cursor for next payment
  Fetched payment 18 (cursor: provided)

📝 Processing Square payment: jhU6YnfsNom1Wu5UEwTpuTUOfkbZY
  📥 Importing non-completed payment - status: FAILED (will not move to production)
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: jhU6YnfsNom1Wu5UEwTpuTUOfkbZY
  🛒 Fetching order: lRHUbFrVLiFaXJ7gCrKirTsbMfJZY
    ✓ Order fetched
  👤 Fetching customer: 6AV409Q89NWNMCVYXM82HSX4RM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  📝 No registration found for payment: jhU6YnfsNom1Wu5UEwTpuTUOfkbZY
  ✓ Updated import_payments with registrationId: no-match
  ℹ️ Failed/refunded payment - no match is not an error
  Got cursor for next payment
  Fetched payment 19 (cursor: provided)

📝 Processing Square payment: ByHBzneYeEzSiok0AlGqi7v7N6NZY
  📥 Importing non-completed payment - status: FAILED (will not move to production)
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: ByHBzneYeEzSiok0AlGqi7v7N6NZY
  🛒 Fetching order: JXP7Z0ckjqFu5oTSv7OudCIjzFRZY
    ✓ Order fetched
  👤 Fetching customer: 6AV409Q89NWNMCVYXM82HSX4RM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  📝 No registration found for payment: ByHBzneYeEzSiok0AlGqi7v7N6NZY
  ✓ Updated import_payments with registrationId: no-match
  ℹ️ Failed/refunded payment - no match is not an error
  Got cursor for next payment
  Fetched payment 20 (cursor: provided)

📝 Processing Square payment: hmHkLkSEY6gu1Nngf1LYIBaLnPJZY
  📥 Importing non-completed payment - status: FAILED (will not move to production)
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: hmHkLkSEY6gu1Nngf1LYIBaLnPJZY
  🛒 Fetching order: hdkX92qVGPjrnucp472nFPOFO9CZY
    ✓ Order fetched
  👤 Fetching customer: 6AV409Q89NWNMCVYXM82HSX4RM
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  📝 No registration found for payment: hmHkLkSEY6gu1Nngf1LYIBaLnPJZY
  ✓ Updated import_payments with registrationId: no-match
  ℹ️ Failed/refunded payment - no match is not an error
  Got cursor for next payment
  Fetched payment 21 (cursor: provided)

📝 Processing Square payment: zNueSiS1Y3GP59FJH7A62k4tMrTZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: zNueSiS1Y3GP59FJH7A62k4tMrTZY
  🛒 Fetching order: Z58Ht3g5mkYiMQhTmacmMT1Ala8YY
    ✓ Order fetched
  👤 Fetching customer: H2TBDHAN3T930V4GB1TGQX8C1C
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 2d56701e-263f-4d25-b037-6a77e4e56b7b
  ✓ Updated import_payments with registrationId: 2d56701e-263f-4d25-b037-6a77e4e56b7b
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Blake Ritchie
    ✓ Updated existing customer: Blake Ritchie
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 1 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📦 Returning 1 processed tickets from registration_data
  ✓ Found 1 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_2d56701e-263f-4d25-b037-6a77e4e56b7b_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment zNueSiS1Y3GP59FJH7A62k4tMrTZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193bfe56fc04fe4a7a0f2')
  Got cursor for next payment
  Fetched payment 22 (cursor: provided)

📝 Processing Square payment: r9ACcx4DHuxDspPsS8xlhWFWKk7YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: r9ACcx4DHuxDspPsS8xlhWFWKk7YY
  🛒 Fetching order: LOQIEp0fpoo284GW6rJFN4AF1UDZY
    ✓ Order fetched
  👤 Fetching customer: HTPP5EW2G6NDF4QS1TM5J7JBH8
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: fc71d5ec-a70d-4874-86d1-ef1e2c05d162
  ✓ Updated import_payments with registrationId: fc71d5ec-a70d-4874-86d1-ef1e2c05d162
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Conrad Hermosura
    ✓ Updated existing customer: Conrad Hermosura
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_fc71d5ec-a70d-4874-86d1-ef1e2c05d162_ticket_0 (Grand Proclamation Ceremony, qty: 1)
  ❌ Error processing Square payment r9ACcx4DHuxDspPsS8xlhWFWKk7YY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193c1e56fc04fe4a7a0fe')
  Got cursor for next payment
  Fetched payment 23 (cursor: provided)

📝 Processing Square payment: BYKXKLGaomF5fqksWnC2BDShYz9YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: BYKXKLGaomF5fqksWnC2BDShYz9YY
  🛒 Fetching order: 3ipF8JMxHBLO2ogMnD1uNmZr2WDZY
    ✓ Order fetched
  👤 Fetching customer: 03BXCTNECW3Q0PS6ZHHQFPZKHW
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 4637d778-f452-4f79-b7a8-0391b1845a90
  ✓ Updated import_payments with registrationId: 4637d778-f452-4f79-b7a8-0391b1845a90
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Servillano Jr Pablo
    ✓ Updated existing customer: Servillano Jr Pablo
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_4637d778-f452-4f79-b7a8-0391b1845a90_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment BYKXKLGaomF5fqksWnC2BDShYz9YY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193c2e56fc04fe4a7a107')
  Got cursor for next payment
  Fetched payment 24 (cursor: provided)

📝 Processing Square payment: H7MsmC9fLnNjwZCB50pm6oUhDZCZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: H7MsmC9fLnNjwZCB50pm6oUhDZCZY
  🛒 Fetching order: boTPJNwfwPvRTWaXWScSeoUlKyeZY
    ✓ Order fetched
  👤 Fetching customer: 0D2A7GXNC745B2VT4YRPN30014
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 58603dca-656b-406a-afa4-3f4770fb13f0
  ✓ Updated import_payments with registrationId: 58603dca-656b-406a-afa4-3f4770fb13f0
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: YOSHIYUKI MIYAUCHI
    ✓ Updated existing customer: YOSHIYUKI MIYAUCHI
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 3 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📦 Returning 3 processed tickets from registration_data
  ✓ Found 3 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_58603dca-656b-406a-afa4-3f4770fb13f0_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment H7MsmC9fLnNjwZCB50pm6oUhDZCZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193c3e56fc04fe4a7a110')
  Got cursor for next payment
  Fetched payment 25 (cursor: provided)

📝 Processing Square payment: Xbs2Q3X1vEvZJnSLSnrbaOF4z1EZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: Xbs2Q3X1vEvZJnSLSnrbaOF4z1EZY
  🛒 Fetching order: jEzTQ8HbksW7bIfngRIiBmxlviSZY
    ✓ Order fetched
  👤 Fetching customer: Q09WRSTJWYVHCKF207VF4583FR
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: ac888821-9ecb-4783-ad3f-08a035cfef88
  ✓ Updated import_payments with registrationId: ac888821-9ecb-4783-ad3f-08a035cfef88
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Nick Pagonis
    ✓ Updated existing customer: Nick Pagonis
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_ac888821-9ecb-4783-ad3f-08a035cfef88_ticket_0 (Grand Proclamation Ceremony, qty: 1)
  ❌ Error processing Square payment Xbs2Q3X1vEvZJnSLSnrbaOF4z1EZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193c4e56fc04fe4a7a11e')
  Got cursor for next payment
  Fetched payment 26 (cursor: provided)

📝 Processing Square payment: 1iYmmAImrRvMZ9FE839tL7f6ZJDZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 1iYmmAImrRvMZ9FE839tL7f6ZJDZY
  🛒 Fetching order: HYKGav4fJYRsoBUB3xHAAoQxWmTZY
    ✓ Order fetched
  👤 Fetching customer: F4Q22YT3MKS6ZFRJABJ950ECTR
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 41139e7f-dc81-4b0e-a937-04be23115719
  ✓ Updated import_payments with registrationId: 41139e7f-dc81-4b0e-a937-04be23115719
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Lynden  Norgate 
    ✓ Updated existing customer: Lynden  Norgate 
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 5 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    🔍 Looking up eventTicket: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    ✅ Found eventTicket: Existing Banquet Ticket bought by Lodge (price: [object Object])
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    🔍 Looking up eventTicket: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    ✅ Found eventTicket: Existing Banquet Ticket bought by Lodge (price: [object Object])
    📦 Returning 5 processed tickets from registration_data
  ✓ Found 5 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_41139e7f-dc81-4b0e-a937-04be23115719_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment 1iYmmAImrRvMZ9FE839tL7f6ZJDZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193c5e56fc04fe4a7a12b')
  Got cursor for next payment
  Fetched payment 27 (cursor: provided)

📝 Processing Square payment: LHxGj2N2xehd2SVPRgahL09Z4bOZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: LHxGj2N2xehd2SVPRgahL09Z4bOZY
  🛒 Fetching order: XEGtndCqAf4f1ABfaZuVtGS4HVCZY
    ✓ Order fetched
  👤 Fetching customer: WSPWWVDESSSE0K3DJ46QPG7ENC
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 6b9d5cfe-7d0e-4524-b3b0-998d4b1d4307
  ✓ Updated import_payments with registrationId: 6b9d5cfe-7d0e-4524-b3b0-998d4b1d4307
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Reggie Acre
    ✓ Updated existing customer: Reggie Acre
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 1 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 1 processed tickets from registration_data
  ✓ Found 1 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_6b9d5cfe-7d0e-4524-b3b0-998d4b1d4307_ticket_0 (Grand Proclamation Ceremony, qty: 1)
  ❌ Error processing Square payment LHxGj2N2xehd2SVPRgahL09Z4bOZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193c6e56fc04fe4a7a137')
  Got cursor for next payment
  Fetched payment 28 (cursor: provided)

📝 Processing Square payment: HnMhwDtTEYP9hcTF0UHH7Y8UTbBZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: HnMhwDtTEYP9hcTF0UHH7Y8UTbBZY
  🛒 Fetching order: F1bR9avUuc9iTrZkrZP6Xa1VdMWZY
    ✓ Order fetched
  👤 Fetching customer: K354S7CHGF4EXFGNNGCXK23Z6G
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 4cbfbf96-09a7-48b7-9f5d-defc560f4437
  ✓ Updated import_payments with registrationId: 4cbfbf96-09a7-48b7-9f5d-defc560f4437
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Joel Diego
    ✓ Updated existing customer: Joel Diego
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 2 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📦 Returning 2 processed tickets from registration_data
  ✓ Found 2 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_4cbfbf96-09a7-48b7-9f5d-defc560f4437_ticket_0 (Grand Proclamation Ceremony, qty: 1)
  ❌ Error processing Square payment HnMhwDtTEYP9hcTF0UHH7Y8UTbBZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193c8e56fc04fe4a7a143')
  Got cursor for next payment
  Fetched payment 29 (cursor: provided)

📝 Processing Square payment: 3tJyXZgwjgLBCHoyV2uARwGBswdZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 3tJyXZgwjgLBCHoyV2uARwGBswdZY
  🛒 Fetching order: V7EIymYDC7yW3oKILWOFhmfrWbJZY
    ✓ Order fetched
  👤 Fetching customer: ZXYM7MEPP9RCXHD77SW7AAQMDR
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 7c2c244d-e49d-42f8-91e9-b17eaf4c524e
  ✓ Updated import_payments with registrationId: 7c2c244d-e49d-42f8-91e9-b17eaf4c524e
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Raymund Joseph Ian Mendoza
    ✓ Updated existing customer: Raymund Joseph Ian Mendoza
    ✓ Updated registration with customer ObjectId
    Extracting 2 attendees from registration_data
  ✓ Found 2 attendee(s)
    Extracting 8 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    🔍 Looking up eventTicket: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    ✅ Found eventTicket: Existing Banquet Ticket bought by Lodge (price: [object Object])
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📝 Using event_ticket_id for eventTicketId: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    🔍 Looking up eventTicket: d586ecc1-e410-4ef3-a59c-4a53a866bc33
    ✅ Found eventTicket: Meet & Greet Cocktail Party (price: 70)
    📝 Using event_ticket_id for eventTicketId: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    🔍 Looking up eventTicket: 7196514b-d4b8-4fe0-93ac-deb4c205dd09
    ✅ Found eventTicket: Grand Proclamation Ceremony (price: 20)
    📝 Using event_ticket_id for eventTicketId: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    🔍 Looking up eventTicket: b8a1ef1f-5f53-4544-af7b-901756b9ba7d
    ✅ Found eventTicket: Existing Banquet Ticket bought by Lodge (price: [object Object])
    📝 Using event_ticket_id for eventTicketId: bce41292-3662-44a7-85da-eeb1a1e89d8a
    🔍 Looking up eventTicket: bce41292-3662-44a7-85da-eeb1a1e89d8a
    ✅ Found eventTicket: Farewell Cruise Luncheon (price: 75)
    📦 Returning 8 processed tickets from registration_data
  ✓ Found 8 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_7c2c244d-e49d-42f8-91e9-b17eaf4c524e_ticket_0 (Meet & Greet Cocktail Party, qty: 1)
  ❌ Error processing Square payment 3tJyXZgwjgLBCHoyV2uARwGBswdZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193c9e56fc04fe4a7a150')
  Got cursor for next payment
  Fetched payment 30 (cursor: provided)

📝 Processing Square payment: vlvOb3ZJBzQJ0XzoCOOCm3lVn2VZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: vlvOb3ZJBzQJ0XzoCOOCm3lVn2VZY
  🛒 Fetching order: fi1gMPy5tJ0VU3VcsDwGyFpo3GTZY
    ✓ Order fetched
  👤 Fetching customer: VAZ79FDMGQN24J5D9A4510B6NW
    ✓ Customer fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 0ffcc96c-c707-4734-b9ee-01e88f7f6287
  ✓ Updated import_payments with registrationId: 0ffcc96c-c707-4734-b9ee-01e88f7f6287
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Robert  Upton 
    ✓ Updated existing customer: Robert  Upton 
    ✓ Updated registration with customer ObjectId
    Extracting 1 attendees from registration_data
  ✓ Found 1 attendee(s)
    Extracting 1 tickets from registration_data.tickets
    📝 Using event_ticket_id for eventTicketId: be94ef03-6647-48d5-97ea-f98c862e30e6
    🔍 Looking up eventTicket: be94ef03-6647-48d5-97ea-f98c862e30e6
    ✅ Found eventTicket: Quarterly Communication (price: 0)
    📦 Returning 1 processed tickets from registration_data
  ✓ Found 1 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_0ffcc96c-c707-4734-b9ee-01e88f7f6287_ticket_0 (Quarterly Communication, qty: 1)
  ❌ Error processing Square payment vlvOb3ZJBzQJ0XzoCOOCm3lVn2VZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193cbe56fc04fe4a7a15f')
  Got cursor for next payment
  Fetched payment 31 (cursor: provided)

📝 Processing Square payment: F8t2nIaFgyXCsaClrIb76CGn5fKZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: F8t2nIaFgyXCsaClrIb76CGn5fKZY
  🛒 Fetching order: ZvtuP9MMxfj5KBVsZL4Utt71gBfZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: 4a7a7ca5-ed7d-4251-b04a-b9169fde77a8
  ✓ Updated import_payments with registrationId: 4a7a7ca5-ed7d-4251-b04a-b9169fde77a8
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Rod Cohen
    ✓ Updated existing customer: Rod Cohen
    ✓ Updated registration with customer ObjectId
  ✓ Found 0 attendee(s)
    Extracting 1 tickets from registration_data.tickets
    🔍 Looking up eventTicket: fd12d7f0-f346-49bf-b1eb-0682ad226216
    ✅ Found eventTicket: Proclamation Banquet - Best Available (price: 115)
    ⚠️ Ticket missing attendeeId (eventTicketId: fd12d7f0-f346-49bf-b1eb-0682ad226216), using registrationId as fallback
    📦 Returning 1 processed tickets from registration_data
  ✓ Found 1 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_4a7a7ca5-ed7d-4251-b04a-b9169fde77a8_ticket_0 (Proclamation Banquet - Best Available, qty: 10)
  ❌ Error processing Square payment F8t2nIaFgyXCsaClrIb76CGn5fKZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193cce56fc04fe4a7a163')
  Got cursor for next payment
  Fetched payment 32 (cursor: provided)

📝 Processing Square payment: DbJ0DmwrCW68Xy80jcjBhSu1TSTZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: DbJ0DmwrCW68Xy80jcjBhSu1TSTZY
  🛒 Fetching order: ZjVvuS4Wu2NCifKxENeFMpKfo8dZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ✓ Found registration: b95234d7-8980-4d48-8854-af9d1fc06b49
  ✓ Updated import_payments with registrationId: b95234d7-8980-4d48-8854-af9d1fc06b49
  ✓ Imported FULL registration to import_registrations with field transformation
  ⏸️ Production sync deferred to selective sync phase (eligible for production sync)
  📝 Processing booking contact as customer
    Customer data created: Joshua Newman
    ✓ Updated existing customer: Joshua Newman
    ✓ Updated registration with customer ObjectId
  ✓ Found 0 attendee(s)
    Extracting 1 tickets from registration_data.tickets
    🔍 Looking up eventTicket: fd12d7f0-f346-49bf-b1eb-0682ad226216
    ✅ Found eventTicket: Proclamation Banquet - Best Available (price: 115)
    ⚠️ Ticket missing attendeeId (eventTicketId: fd12d7f0-f346-49bf-b1eb-0682ad226216), using registrationId as fallback
    📦 Returning 1 processed tickets from registration_data
  ✓ Found 1 ticket(s) in registration
    💾 Saving ticket to import_tickets: import_b95234d7-8980-4d48-8854-af9d1fc06b49_ticket_0 (Proclamation Banquet - Best Available, qty: 10)
  ❌ Error processing Square payment DbJ0DmwrCW68Xy80jcjBhSu1TSTZY: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('68a193cce56fc04fe4a7a167')
  Got cursor for next payment
  Fetched payment 33 (cursor: provided)

📝 Processing Square payment: 3ZJ3HBSr4UdPafNCaBainy55wc7YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: 3ZJ3HBSr4UdPafNCaBainy55wc7YY
  🛒 Fetching order: 1D6JIYsyPosqijXocbFPCziiNcbZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: 3ZJ3HBSr4UdPafNCaBainy55wc7YY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 34 (cursor: provided)

📝 Processing Square payment: XZvsmRdAo7cOcbytf8tXyQopLI6YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: XZvsmRdAo7cOcbytf8tXyQopLI6YY
  🛒 Fetching order: Xs2L35wjYWhx3HvrklClX3a0BuNZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: XZvsmRdAo7cOcbytf8tXyQopLI6YY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 35 (cursor: provided)

📝 Processing Square payment: lqOt4jZnIiTTlE97PDYCV3tShsPZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: lqOt4jZnIiTTlE97PDYCV3tShsPZY
  🛒 Fetching order: r4PTP2Qxwslt7ZxZaKlLzqYSShcZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: lqOt4jZnIiTTlE97PDYCV3tShsPZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 36 (cursor: provided)

📝 Processing Square payment: zVoh8VCpVfGVFHDPCb6tQiG9uJ8YY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: zVoh8VCpVfGVFHDPCb6tQiG9uJ8YY
  🛒 Fetching order: DARLGQPmU3VLYeCjH2NCxjYWrgHZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: zVoh8VCpVfGVFHDPCb6tQiG9uJ8YY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 37 (cursor: provided)

📝 Processing Square payment: ZggJj2u2p8iwhRWOajCzg0zZ2YEZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: ZggJj2u2p8iwhRWOajCzg0zZ2YEZY
  🛒 Fetching order: fCV69dX4Zze30HVeTpuzqAjjWUaZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: ZggJj2u2p8iwhRWOajCzg0zZ2YEZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 38 (cursor: provided)

📝 Processing Square payment: jjZo8QIRaYRVHjWEF6kGT2A8SqYZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: jjZo8QIRaYRVHjWEF6kGT2A8SqYZY
  🛒 Fetching order: PsYp8u1YP1En0Te0r2ckAR3x3xCZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: jjZo8QIRaYRVHjWEF6kGT2A8SqYZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
  Fetched payment 39 (cursor: provided)

📝 Processing Square payment: XbYcqGOlLYy34w8GRh6oDKYqSKKZY
  ✅ Importing completed payment - status: COMPLETED
  🔄 Payment has been updated - cleaning up and reprocessing
  🧹 Checking for stale error_payments records for payment: XbYcqGOlLYy34w8GRh6oDKYqSKKZY
  🛒 Fetching order: P69g27WnaUvxwgatO0njdtNHp5SZY
    ✓ Order fetched
  ✓ Imported to import_payments with field transformation
  ❌ No registration found for payment: XbYcqGOlLYy34w8GRh6oDKYqSKKZY
  ✓ Updated import_payments with registrationId: no-match
  Got cursor for next payment
