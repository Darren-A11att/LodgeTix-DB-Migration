=== ENHANCED PAYMENT SYNC LOG ===
Started at: 2025-08-18T11:18:21.952Z
Processing Square with orders/customers and contacts

âœ“ Supabase client initialized
âœ“ Square provider initialized (REQUIRED)
âœ“ DA-LODGETIX initialized
âœ“ WS-LODGETIX initialized
âœ“ WS-LODGETICKETS initialized

Initialized 4 payment provider(s)
âœ“ Connected to MongoDB:
  Cluster: LodgeTix-migration-test-1
  Database: lodgetix
  URI: mongodb+srv:****@lodgetix-migration-test.wydwfu6.mongodb.net/lodgetix?retryWrites=true&w=majority&appName=LodgeTix-migration-test-1

=== STARTING ENHANCED PAYMENT SYNC ===
Processing workflow:
1. Import payment to import_payments (with field transformation)
2. Fetch order/customer for Square payments
3. Find registration in Supabase
4. Update with charge ID for Stripe
5. Import to import_registrations (with field transformation)
6. Import attendees to import_attendees
7. Import tickets to import_tickets
8. Import contacts to import_contacts with deduplication
9. Process booking contact as customer with registration metadata
9. Selective sync to production collections based on field comparison


â”â”â” Processing Square â”â”â”

Fetching ALL historical Square payments (one at a time)...
  Fetched payment 1 (cursor: none)

ğŸ“ Processing Square payment: F6oCqaqnzPwfTGdhPYIZIBucz3HZY
  âœ… Importing completed payment - status: COMPLETED
  âœ“ Payment already exists in production - skipping
Reached limit of 1 for Square

â”â”â” Processing DA-LODGETIX â”â”â”

ğŸ“ Processing charge: ch_3RYNqYKBASow5NsW17D1d6gl
  âœ… Importing successful charge - status: succeeded
  âœ“ Charge already exists in production - skipping
Reached limit of 1 for DA-LODGETIX

â”â”â” Processing WS-LODGETIX â”â”â”

ğŸ“ Processing charge: ch_3RatsQHDfNBUEWUu0i6JkO6W
  âœ… Importing successful charge - status: succeeded
  âœ“ Charge already exists in production - skipping
Reached limit of 1 for WS-LODGETIX

â”â”â” Processing WS-LODGETICKETS â”â”â”

ğŸ“ Processing charge: ch_3RbJfOCari1bgsWq0CxPr7NI
  âœ… Importing successful charge - status: succeeded
  âœ“ Charge already exists in production - skipping
Reached limit of 1 for WS-LODGETICKETS

âœ… All payments processed with immediate production sync
   Each payment's complete data chain was synced to production before processing the next payment
   This prevents orphaned tickets and ensures all relationships are properly maintained

ğŸ” Starting Error Verification...
Checking error documents against test database...


ğŸ“Š VERIFICATION RESULTS:
Error Payments - Found: 0, Not Found: 0
Error Registrations - Found: 0, Not Found: 0
Orphaned Registrations - Found: 0, Not Found: 0
âœ… Error verification completed


ğŸ›’ Processing Orders from Registrations...
âœ… Orders created: 0
â­ï¸ Orders skipped: 4
âš ï¸ Order processing errors: 4

=== SYNC COMPLETE ===
âœ… Processed: 0
â­ï¸ Skipped: 4
âŒ Errors: 0
ğŸ‘¥ Unique contacts: 0
ğŸ“Š Total: 4
